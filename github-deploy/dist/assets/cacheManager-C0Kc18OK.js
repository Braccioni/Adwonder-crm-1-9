import{h as r}from"./index-DgQnJBRP.js";const l=[{id:"1",nome_azienda:"Azienda Demo 1",figura_preposta:"Mario Rossi",contatti:"+39 123 456 7890",indirizzo_mail:"mario.rossi@demo1.com",data_invio_proposta:"2024-01-15",proposta_presentata:"Proposta Marketing Digitale",tipologia_proposta:"advertising",frequenza:"mensile",valore_mensile:2500,valore_spot:0,stato_trattativa:"in_corso",data_fine:void 0,giorni_gestazione:30,durata:"12 mesi",fine_lavori:void 0,estensione:void 0,user_id:"admin-user",created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-15T00:00:00Z"},{id:"2",nome_azienda:"Azienda Demo 2",figura_preposta:"Laura Bianchi",contatti:"+39 987 654 3210",indirizzo_mail:"laura.bianchi@demo2.com",data_invio_proposta:"2024-02-01",proposta_presentata:"Consulenza SEO",tipologia_proposta:"nuovo_sito",frequenza:"una_tantum",valore_mensile:0,valore_spot:5e3,stato_trattativa:"vinta",data_fine:"2024-02-15",giorni_gestazione:14,durata:"3 mesi",fine_lavori:"2024-05-15",estensione:void 0,user_id:"admin-user",created_at:"2024-02-01T00:00:00Z",updated_at:"2024-02-15T00:00:00Z"}],u=[{id:"1",client_id:"1",oggetto_trattativa:"Campagna Marketing Q1",valore_stimato:2500,data_apertura:"2024-01-01T00:00:00Z",stato_trattativa:"in_corso",scadenza_prossimo_contatto:"2024-01-20T00:00:00Z",note:"Cliente interessato, da ricontattare",user_id:"admin-user",created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-15T00:00:00Z"},{id:"2",client_id:"2",oggetto_trattativa:"Progetto SEO",valore_stimato:5e3,data_apertura:"2024-02-01T00:00:00Z",stato_trattativa:"vinta",scadenza_prossimo_contatto:void 0,note:"Contratto firmato",user_id:"admin-user",created_at:"2024-02-01T00:00:00Z",updated_at:"2024-02-15T00:00:00Z"}],m={total_clients:2,active_deals:1,won_deals:1,lost_deals:0,total_deal_value:2500,this_week_activities:2,pending_notifications:1,contracts_expiring_soon:1,best_client_by_revenue:{nome_azienda:"Azienda Demo 2",total_revenue:5e3},best_client_by_contract_duration:{nome_azienda:"Azienda Demo 1",contract_duration_months:12},best_sales_performance:{best_month:{month:"2024-02",deals_count:1,total_value:5e3},best_day:{date:"2024-02-15",deals_count:1},biggest_deal:{oggetto_trattativa:"Progetto SEO",valore_stimato:5e3,client_name:"Azienda Demo 2"}}},s=(i=500)=>new Promise(t=>setTimeout(t,i)),h=async(i,t)=>{if(await c())return await s(200),i;try{return await t()}catch(e){return console.warn("Real data fetch failed, falling back to mock data:",e),await s(100),i}},c=async()=>await r();class d{constructor(){this.cache=new Map,this.DEFAULT_TTL=5*60*1e3}set(t,a,e=[],o=this.DEFAULT_TTL){this.cache.set(t,{data:a,timestamp:Date.now()+o,dependencies:e})}get(t){const a=this.cache.get(t);return a?Date.now()>a.timestamp?(this.cache.delete(t),null):a.data:null}invalidate(t){this.cache.delete(t);const a=[];for(const[e,o]of this.cache.entries())o.dependencies.includes(t)&&a.push(e);a.forEach(e=>{this.cache.delete(e)})}invalidateAll(){this.cache.clear()}has(t){const a=this.cache.get(t);return a!==void 0&&Date.now()<=a.timestamp}getStats(){return{size:this.cache.size,keys:Array.from(this.cache.keys())}}cleanup(){const t=Date.now(),a=[];for(const[e,o]of this.cache.entries())t>o.timestamp&&a.push(e);a.forEach(e=>this.cache.delete(e))}}const n=new d,p=()=>{n.invalidate("clients"),n.invalidate("dashboard")};typeof window<"u"&&setInterval(()=>{n.cleanup()},10*60*1e3);export{s as a,u as b,n as c,l as d,h as g,p as i,m,c as s};
